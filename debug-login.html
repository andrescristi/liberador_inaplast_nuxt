<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Login - Test de Inicialización</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .error { color: red; background: #ffe6e6; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .success { color: green; background: #e6ffe6; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .info { color: blue; background: #e6f3ff; padding: 10px; margin: 10px 0; border-radius: 4px; }
        button { padding: 10px 20px; margin: 5px; }
        #console { background: #f0f0f0; padding: 10px; margin: 10px 0; min-height: 200px; font-family: monospace; white-space: pre-wrap; }
    </style>
</head>
<body>
    <h1>Debug - Test de Inicialización JavaScript</h1>
    
    <div class="info">
        Esta página carga los mismos chunks que la página de login para detectar errores de inicialización.
    </div>

    <button onclick="testChunkLoading()">Test Chunk Loading</button>
    <button onclick="clearConsole()">Clear Console</button>
    
    <div id="status"></div>
    <div id="console"></div>

    <script>
        const status = document.getElementById('status');
        const consoleDiv = document.getElementById('console');
        
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logLine = `[${timestamp}] ${message}\n`;
            consoleDiv.textContent += logLine;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
            
            if (type === 'error') {
                status.innerHTML = `<div class="error">ERROR: ${message}</div>`;
            } else if (type === 'success') {
                status.innerHTML = `<div class="success">SUCCESS: ${message}</div>`;
            }
        }
        
        function clearConsole() {
            consoleDiv.textContent = '';
            status.innerHTML = '';
        }
        
        // Capture all errors
        window.onerror = function(msg, url, lineNo, columnNo, error) {
            log(`Global Error: ${msg} at ${url}:${lineNo}:${columnNo}`, 'error');
            return false;
        };
        
        window.addEventListener('unhandledrejection', function(event) {
            log(`Unhandled Promise Rejection: ${event.reason}`, 'error');
        });
        
        async function testChunkLoading() {
            log('Starting chunk loading test...');
            
            try {
                // Test loading main chunks
                const chunks = [
                    '/_nuxt/vendor-CKMWg9PQ.js',
                    '/_nuxt/entry-D6nssMLx.js',
                    '/_nuxt/framework-BGph7VvM.js'
                ];
                
                for (const chunk of chunks) {
                    log(`Loading chunk: ${chunk}`);
                    
                    const response = await fetch(chunk);
                    if (!response.ok) {
                        log(`Failed to fetch ${chunk}: ${response.status}`, 'error');
                        return;
                    }
                    
                    const content = await response.text();
                    log(`Loaded ${chunk} - Size: ${content.length} chars`);
                    
                    // Check for common initialization problems
                    if (content.includes('Cannot access') && content.includes('before initialization')) {
                        log(`FOUND INITIALIZATION ISSUE in ${chunk}`, 'error');
                        const match = content.match(/Cannot access '([^']+)' before initialization/);
                        if (match) {
                            log(`Problematic variable: ${match[1]}`, 'error');
                        }
                    }
                }
                
                log('All chunks loaded successfully!', 'success');
                
            } catch (error) {
                log(`Test failed: ${error.message}`, 'error');
            }
        }
        
        log('Debug page loaded - Ready for testing');
    </script>
</body>
</html>